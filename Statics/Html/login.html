<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="{{url_for('static', filename ='CSS/ai.css')}}"> -->
    <link rel="stylesheet" href="../CSS/ai.css">


    <title>Document</title>
</head>
<body>
    <!-- 登录 -->
    <div class="log login" id="login">
        <div class="login-box">
            <h2>登  录</h2>
            <form>
                <div class="user-box">
                    <input type="text" id="username">
                    <label>用户名</label>
                </div>
                <div class="user-box">
                    <input type="password" id="passwordid">
                    <label>密码</label>
                </div>
                <!-- <a id="register">
                    register
                </a> -->
                <div class="register" id="registerInLogin" onclick="register()">新用户注册</div>
                <a id="submit">
                    <!-- Register -->
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    提 交
                </a>
            </form>
        </div>
    </div>

    <!-- 注册 -->
    <div class="login" id="register">
        <div class="login-box">
            <h2>新 用 户 注 册</h2>
            <form>
                <div class="user-box">
                    <input type="text" id="newUser">
                    <label>设置用户名</label>
                </div>
                <div class="user-box">
                    <input type="password" id="newUserPassword">
                    <label>设置密码</label>
                </div>
                <!-- <a id="register">
                    register
                </a> -->
                <div class="register" id="loginInRegister">已有账号直接登录</div>
                <a id="registerSubmit">
                    <!-- Register -->
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    提 交
                </a>
            </form>
        </div>
    </div>
</body>
<script>
    function loginin() {
        if (document.cookie == '') {
            document.getElementById('logout').style.display = 'none';
            document.getElementById('login').style.display = 'block';
            $('#submit').click(function() { //点击按钮
                var username = hex_md5(document.getElementById('username').value)
                var password = hex_md5(document.getElementById('passwordid').value)
                var subjectName = '人工智能'
                // alert(username, password)
                $.post('/login', {
                    username: username,
                    password: password,
                    subjectName: subjectName
                    }).then(function(response) {
                        if (response == 'fail') {
                            alert('用户名密码不存在')
                        }else {
                            setCookie(username, password, 10)
                            // document.cookie = username + "=" + password + "; expires=Thu, 1 Dec 2022 03:30:00 GMT";
                            // alert(document.cookie)
                            document.getElementById('login').style.display = 'none';
                            document.getElementById('logout').style.display = 'block';
                        }
                });
            })
        }else {
            document.getElementById('logout').style.display = 'block';
            cookie = document.cookie
            cookieList = cookie.split('=')
            $.post('/login', {
                username: cookieList[0],
                password: cookieList[1]
            })
        }
    }

    loginin()
</script>
</html>